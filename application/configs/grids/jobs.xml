<?xml version="1.0" encoding="UTF-8"?>
<grids>
    <jobs>
        <title>Lavori</title>
        <addlink>/jobs/new</addlink>
        <addtitle>Nuovo lavoro</addtitle>
        <parameters>
            <currIdProgetto>
                <from>arrdefaultnamespace</from>
                <array>currProject</array>
                <offset>idProgetto</offset>
            </currIdProgetto>
            <currIdProgStep>
                <from>arrdefaultnamespace</from>
                <array>currStep</array>
                <offset>idProgStep</offset>
            </currIdProgStep>
            <currIdRichiesta>
                <from>arrdefaultnamespace</from>
                <array>currReq</array>
                <offset>idRichiesta</offset>
            </currIdRichiesta>
            <aclReadonly>
                <from>defaultnamespace</from>
            </aclReadonly>
            <canDelete>
                <from>cond</from>
                <type>eq</type>
                <op1>{{aclReadonly}}</op1>
                <op2>1</op2>
            </canDelete>
        </parameters>
        <select>
            <from>
                <aliasname>
                    <jobs>jobs</jobs>
                </aliasname>
                <fields>
                    <idJob>idJob</idJob>
                    <Inizio>Inizio</Inizio>
                    <Fine>Fine</Fine>
                    <SalGG>SalGG</SalGG>
                    <SalOrario>SalOrario</SalOrario>
                    <Note>Note</Note>
                </fields>
            </from>
            <join id='personale'>
                <type>left</type>
                <cond>personale.idPersonale = jobs.idPersonale</cond>
                <aliasname>
                    <personale>personale</personale>
                </aliasname>
                <fields>
                    <Nome>Nome</Nome>
                    <Cognome>Cognome</Cognome>
                </fields>
            </join>
            <join id='forn_pers'>
                <type>left</type>
                <cond>forn_pers.idFornPers = personale.idFornPers</cond>
                <aliasname>
                    <forn_pers>forn_pers</forn_pers>
                </aliasname>
                <fields>
                    <RagSoc>RagSoc</RagSoc>
                </fields>
            </join>
            <where>
                <from>
                    jobs.idRichiesta = "{{currIdRichiesta}}"
                </from>
            </where>
        </select>
        <updatecolumns>
            <idJob>
                <hidden>1</hidden>
            </idJob>
            <Inizio>
                <position>1</position>
                <title>Inizio</title>
<!--                <class>width_75</class>
                <format>date</format>
                <format>
                    <locale>it-IT</locale>
                    <date_format>dd/MM/y</date_format>
                </format>-->
            </Inizio>
            <Fine>
                <position>2</position>
                <title>Fine</title>
<!--                <class>width_75</class>
                <format>date</format>
                <format>
                    <locale>it-IT</locale>
                    <date_format>dd/MM/y</date_format>
                </format>-->
            </Fine>
            <Nome>
                <title>Nome</title>
                <position>3</position>
            </Nome>
            <Cognome>
                <title>Cognome</title>
                <position>4</position>
            </Cognome>
            <RagSoc>
                <title>Fornitore</title>
                <position>5</position>
            </RagSoc>
            <SalGG>
                <title>Rate/GG</title>
                <position>6</position>
                <class>width_90</class>
                <format>currency</format>
                <format>
                    <locale>it-IT</locale>
                </format>
            </SalGG>
            <SalOrario>
                <title>Rate/Ora</title>
                <position>7</position>
                <class>width_90</class>
                <format>currency</format>
                <format>
                    <locale>it-IT</locale>
                </format>
            </SalOrario>
            <Note>
                <title>Note</title>
                <position>8</position>
            </Note>
        </updatecolumns>
        <updateCallbacks>
            <Inizio>
                <class>Custom_GridCallback</class>
                <method>format_date</method>
                <params>{{Inizio}}</params>
            </Inizio>
            <Fine>
                <class>Custom_GridCallback</class>
                <method>format_date</method>
                <params>{{Fine}}</params>
            </Fine>
            <End></End>
        </updateCallbacks>        
        <extracolumns>
            <Edit>
                <position>left</position>
                <title>Edit</title>
                <decorator>
                    /jobs/edit/id/{{idJob}}#/images/edit.png#Edit
                </decorator>
            </Edit>
            <if>
                <cond>{{canDelete}}</cond>
                <iftrue>
                </iftrue>
                <iffalse>                    
                    <Del>
                        <position>left</position>
                        <title>Delete</title>
                        <decorator>
                            /jobs/delete/id/{{idJob}}#/images/fechar.png#Edit
                        </decorator>
                    </Del>
                </iffalse>
            </if>
        </extracolumns>
    </jobs>
</grids>