<?xml version="1.0" encoding="UTF-8"?>
<grids>
    <visti>
        <title>Visti</title>
        <addlink>/passport/newvisto</addlink>
        <addtitle>Nuovo visto</addtitle>
<!--        <parameters>
            <currPass>
                <from>pararr</from>
            </currPass>
        </parameters>-->
        <parameters>
            <pass_id>
                <from>arrdefaultnamespace</from>
                <array>currPers</array>
                <offset>idPass</offset>
            </pass_id>
        </parameters>
        <select>
            <from>
                <aliasname>
                    <visti>visti</visti>
                </aliasname>
                <fields>
                    <idVisto>idVisto</idVisto>
                    <idPass>idPass</idPass>
                    <Paese>Paese</Paese>
                    <Rilascio>Rilascio</Rilascio>
                    <Scadenza>Scadenza</Scadenza>
                    <MaxPermanenza>MaxPermanenza</MaxPermanenza>
                    <Limitazioni>Limitazioni</Limitazioni>
                    <Note>Note</Note>
                </fields>
            </from>
            <join id='tab_visa_types'>
                <type>left</type>
                <cond>tab_visa_types.idVisaType = visti.idVisaType</cond>
                <aliasname>
                    <tab_visa_types>tab_visa_types</tab_visa_types>
                </aliasname>
                <fields>
                    <VisaType>VisaType</VisaType>
                </fields>
            </join>
            <join></join>
            <where>
                <from>
                idPass = "{{pass_id}}"                    
                </from>
            </where>
        </select>
        <updatecolumns>
            <idVisto>
                <hidden>1</hidden>
            </idVisto>
            <idPass>
                <hidden>1</hidden>
            </idPass>
            <Paese>
                <title>Paese</title>
                <position>1</position>
            </Paese>
            <VisaType>
                <title>Tipo</title>
                <position>2</position>
            </VisaType>
            <Rilascio>
                <position>3</position>
                <title>Data rilascio</title>
                <format>date</format>
                <format>
                    <locale>it-IT</locale>
                    <date_format>dd/MM/y</date_format>
                </format>
            </Rilascio>
            <Scadenza>
                <position>4</position>
                <title>Scadenza</title>
                <format>date</format>
                <format>
                    <locale>it-IT</locale>
                    <date_format>dd/MM/y</date_format>
                </format>
            </Scadenza>
            <MaxPermanenza>
                <position>5</position>
                <title>Permanenza</title>
            </MaxPermanenza>
            <Limitazioni>
                <title>Limitazioni</title>
                <position>6</position>
            </Limitazioni>
            <Note>
                <title>Note</title>
                <position>7</position>
            </Note>
        </updatecolumns>
        <updateCallbacks>
            <Scadenza>
                <class>Custom_GridCallback</class>
                <method>format_date</method>
                <params>{{Scadenza}}</params>
            </Scadenza>
            <Rilascio>
                <class>Custom_GridCallback</class>
                <method>format_date</method>
                <params>{{Rilascio}}</params>
            </Rilascio>
            <End></End>
        </updateCallbacks>        
        <extracolumns>
            <Edit>
                <position>left</position>
                <title>Edit</title>
                <decorator>
                    /passport/editvisto/id/{{idVisto}}#/images/edit.png#Edit
                </decorator>
            </Edit>
            <Del>
                <position>left</position>
                <title>Delete</title>
                <decorator>
                    <link>/passport/delvisto/id/{{idVisto}}</link>
                    <linkstyle>cursor:help;</linkstyle>
                    <linkimg>/images/fechar.png</linkimg>
                    <onclick>return(confirm('Confirm delete?'));</onclick>
                    <linkalt>Delete</linkalt>
                    <linktitle>Delete</linktitle>                    
                </decorator>
            </Del>
        </extracolumns>
    </visti>
</grids>