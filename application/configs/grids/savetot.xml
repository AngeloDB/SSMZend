<?xml version="1.0" encoding="UTF-8"?>
<grids>
    <savetot>
        <title>Revisions</title>
        <parameters>
            <id_project>
                <from>arrdefaultnamespace</from>
                <array>currProject</array>
                <offset>idProgetto</offset>
            </id_project>
        </parameters>        
<!--        <addlink>/business-units/new</addlink>
        <addtitle>Nuova Business Unit</addtitle>-->
        <select>
            <from>
                <aliasname>
                    <savetot>savetot</savetot>
                </aliasname>
                <fields>
                    <idSaveTot>savetot.idSaveTot</idSaveTot>
                    <Reference>savetot.Reference</Reference>
                    <RefFormatDate>DATE_FORMAT(savetot.Reference, "%d/%m/%Y")</RefFormatDate>
                    <Versione>savetot.Versione</Versione>
                    <ZeroVers>(savetot.Versione-1)</ZeroVers>
                    <TotGG>savetot.TotGG</TotGG>
                    <TotContrGG>savetot.TotContrGG</TotContrGG>
                    <Note>savetot.Note</Note>
                </fields>
            </from>
            <where>
                <from>
                savetot.idSaveTot IN (SELECT MAX(st1.idSaveTot) FROM savetot st1 WHERE st1.idProgetto = "{{id_project}}" GROUP BY Versione)
                </from>
            </where>
            <order>savetot.Reference</order>                        
        </select>
        <updatecolumns>
            <idSaveTot>
                <hidden>1</hidden>
            </idSaveTot>
            <Reference>
                <hidden>1</hidden>
            </Reference>
            <Versione>
                <hidden>1</hidden>
            </Versione>
            <ZeroVers>
                <title>Revision</title>
                <position>1</position>
            </ZeroVers>
<!--            <RefFormatDate>
                <position>2</position>
                <title>Reference</title>
                <format>date</format>
                <format>
                    <locale>it-IT</locale>
                    <date_format>dd/MM/y</date_format>
                </format>
            </RefFormatDate>-->
            <Reference>
                <position>2</position>
                <title>Reference</title>
<!--                <format>date</format>
                <format>
                    <locale>it-IT</locale>
                    <date_format>dd/MM/y</date_format>
                </format>-->
            </Reference>
            <TotGG>
                <title>Man/days</title>
                <position>3</position>
            </TotGG>
            <TotContrGG>
                <title>Contr. M/D</title>
                <position>4</position>
            </TotContrGG>
            <Note>
                <title>Note</title>
            </Note>
        </updatecolumns>
        <updateCallbacks>
            <Reference>
                <class>Custom_GridCallback</class>
                <method>format_date</method>
                <params>{{Reference}}</params>
            </Reference>
            <End></End>
        </updateCallbacks>        
        <extracolumns>
            <Edit>
                <position>left</position>
                <title>Detail</title>
                <decorator>
                    <link>
                        #
                    </link>
                    <linkstyle>
                        cursor:help;
                    </linkstyle>
                    <onclick>return(callDetail({{idSaveTot}}));</onclick>
                    <linkimg>
                            /images/viewIcon.png
                    </linkimg>
                    <linkalt>
                            Detail
                    </linkalt>
                    <linktitle>
                            Detail
                    </linktitle>                    
                </decorator>
            </Edit>
        </extracolumns>
    </savetot>
</grids>